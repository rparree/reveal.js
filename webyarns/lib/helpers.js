"use strict";

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

(function (factory) {
  if ((typeof exports === "undefined" ? "undefined" : _typeof(exports)) === 'object') {
    // Node. Does not work with strict CommonJS.
    module.exports = factory(true);
  } else {
    // Browser globals.
    window.Webyarns = factory();
  }
})(function () {
  var exposeAllForTests = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

  var compose = function compose(f, g) {
    return function (x) {
      return g(f(x));
    };
  };

  var attributeNames = function attributeNames(e) {
    return Array.from(e.attributes).map(function (a) {
      return a.name;
    });
  };

  var oneOfContainedIn = function oneOfContainedIn(a2) {
    return function (a1) {
      return a1.some(function (r) {
        return a2.includes(r);
      });
    };
  };

  var containsOneOfAttributes = function containsOneOfAttributes(names) {
    return compose(attributeNames, oneOfContainedIn(names));
  };

  var isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;
  /******
   * Count the number of direct siblings matching a selector,
   ******/

  var count = function count(sb) {
    var fn = function fn(e, attributeNames) {
      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var next = sb(e);
      return next && containsOneOfAttributes(attributeNames)(next) ? fn(next, attributeNames, i + 1) : i;
    };

    return fn;
  };

  var countNext = count(function (n) {
    return n.nextElementSibling;
  });
  var countPrev = count(function (n) {
    return n.previousElementSibling;
  });
  /******
   * Count the number of direct hidden sections
   ******/

  var genericHidingElements = ["data-hidden-section", isTouchDevice ? "data-non-touch-only-section" : "data-touch-only-section"];

  var countHiddenSiblings = function countHiddenSiblings(fn) {
    return function (e) {
      return fn(e, genericHidingElements);
    };
  };

  var noOfHiddenLeft = function noOfHiddenLeft(e) {
    return countPrev(e, ["data-right-only-section"].concat(genericHidingElements));
  };

  var noOfHiddenRight = function noOfHiddenRight(e) {
    return countNext(e, ["data-left-only-section"].concat(genericHidingElements));
  };
  /******
   * Support for next-slide-idx
   ******/


  var getNextSlideIndexH = function getNextSlideIndexH(e) {
    var s = e.getAttribute("data-next-slide-indexh");

    try {
      return s ? parseInt(s, 10) : null;
    } catch (e) {
      throw Error("data-next-slide-indexh, must be a number, got ".concat(s));
    }
  };
  /******
   * Exports
   ******/


  var Webyarns = {
    noOfHiddenLeft: noOfHiddenLeft,
    noOfHiddenRight: noOfHiddenRight,
    getNextSlideIndexH: getNextSlideIndexH
  };

  if (exposeAllForTests) {
    // For Jest
    Webyarns.countNext = countNext;
    Webyarns.countPrev = countPrev;
  }

  return Webyarns;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9oZWxwZXJzLnRzIl0sIm5hbWVzIjpbImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwid2luZG93IiwiV2VieWFybnMiLCJleHBvc2VBbGxGb3JUZXN0cyIsImNvbXBvc2UiLCJmIiwiZyIsIngiLCJhdHRyaWJ1dGVOYW1lcyIsImUiLCJBcnJheSIsImZyb20iLCJhdHRyaWJ1dGVzIiwibWFwIiwiYSIsIm5hbWUiLCJvbmVPZkNvbnRhaW5lZEluIiwiYTIiLCJhMSIsInNvbWUiLCJyIiwiaW5jbHVkZXMiLCJjb250YWluc09uZU9mQXR0cmlidXRlcyIsIm5hbWVzIiwiaXNUb3VjaERldmljZSIsIm5hdmlnYXRvciIsIm1heFRvdWNoUG9pbnRzIiwibXNNYXhUb3VjaFBvaW50cyIsImNvdW50Iiwic2IiLCJmbiIsImkiLCJuZXh0IiwiY291bnROZXh0IiwibiIsIm5leHRFbGVtZW50U2libGluZyIsImNvdW50UHJldiIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJnZW5lcmljSGlkaW5nRWxlbWVudHMiLCJjb3VudEhpZGRlblNpYmxpbmdzIiwibm9PZkhpZGRlbkxlZnQiLCJub09mSGlkZGVuUmlnaHQiLCJnZXROZXh0U2xpZGVJbmRleEgiLCJzIiwiZ2V0QXR0cmlidXRlIiwicGFyc2VJbnQiLCJFcnJvciJdLCJtYXBwaW5ncyI6Ijs7OztBQUFDLFdBQVVBLE9BQVYsRUFBbUI7QUFDaEIsTUFBSSxRQUFPQyxPQUFQLHlDQUFPQSxPQUFQLE9BQW1CLFFBQXZCLEVBQWlDO0FBQzdCO0FBQ0FDLElBQUFBLE1BQU0sQ0FBQ0QsT0FBUCxHQUFpQkQsT0FBTyxDQUFDLElBQUQsQ0FBeEI7QUFDSCxHQUhELE1BR087QUFDSDtBQUVBRyxJQUFBQSxNQUFNLENBQUNDLFFBQVAsR0FBa0JKLE9BQU8sRUFBekI7QUFDSDtBQUNKLENBVEEsRUFTQyxZQUF3QztBQUFBLE1BQXZDSyxpQkFBdUMsdUVBQVYsS0FBVTs7QUFFdEMsTUFBTUMsT0FBTyxHQUFH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LGtCQUFxQixDQUFDakMsQ0FBRCxFQUErQjtBQUN0RCxRQUFNa0MsQ0FBQyxHQUFHbEMsQ0FBQyxDQUFDbUMsWUFBRixDQUFlLHdCQUFmLENBQVY7O0FBQ0EsUUFBSTtBQUNBLGFBQU9ELENBQUMsR0FBR0UsUUFBUSxDQUFDRixDQUFELEVBQUksRUFBSixDQUFYLEdBQXFCLElBQTdCO0FBQ0gsS0FGRCxDQUVFLE9BQU9sQyxDQUFQLEVBQVU7QUFDUixZQUFNcUMsS0FBSyx5REFBa0RILENBQWxELEVBQVg7QUFDSDtBQUNKLEdBUEQ7QUFVQTs7Ozs7QUFHQSxNQUFNekMsUUFBZSxHQUFHO0FBQ3BCc0MsSUFBQUEsY0FBYyxFQUFkQSxjQURvQjtBQUVwQkMsSUFBQUEsZUFBZSxFQUFmQSxlQUZvQjtBQUdwQkMsSUFBQUEsa0JBQWtCLEVBQWxCQTtBQUhvQixHQUF4Qjs7QUFPQSxNQUFJdkMsaUJBQUosRUFBdUI7QUFDbkI7QUFDQUQsSUFBQUEsUUFBUSxDQUFDK0IsU0FBVCxHQUFxQkEsU0FBckI7QUFDQS9CLElBQUFBLFFBQVEsQ0FBQ2tDLFNBQVQsR0FBcUJBLFNBQXJCO0FBQ0g7O0FBRUQsU0FBT2xDLFFBQVA7QUFDSCxDQS9FQSxDQUFEIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIChmYWN0b3J5KSB7XG4gICAgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAvLyBOb2RlLiBEb2VzIG5vdCB3b3JrIHdpdGggc3RyaWN0IENvbW1vbkpTLlxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkodHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQnJvd3NlciBnbG9iYWxzLlxuXG4gICAgICAgIHdpbmRvdy5XZWJ5YXJucyA9IGZhY3RvcnkoKTtcbiAgICB9XG59KChleHBvc2VBbGxGb3JUZXN0czogYm9vbGVhbiA9IGZhbHNlKSA9PiB7XG5cbiAgICBjb25zdCBjb21wb3NlID0gPEEsIEIsIEM+KGY6IChhcmc6IEEpID0+IEIsIGc6IChhcmc6IEIpID0+IEMpOiAoYXJnOiBBKSA9PiBDID0+IHggPT4gZyhmKHgpKTtcbiAgICBjb25zdCBhdHRyaWJ1dGVOYW1lczogKGU6IEVsZW1lbnQpID0+IHN0cmluZ1tdID0gKGU6IEVsZW1lbnQpID0+IEFycmF5LmZyb20oZS5hdHRyaWJ1dGVzKS5tYXAoYSA9PiBhLm5hbWUpO1xuICAgIGNvbnN0IG9uZU9mQ29udGFpbmVkSW4gPSA8VD4oYTI6IEFycmF5PFQ+KSA9PiAoYTE6IEFycmF5PFQ+KSA9PiBhMS5zb21lKHIgPT4gYTIuaW5jbHVkZXMocikpO1xuICAgIGNvbnN0IGNvbnRhaW5zT25lT2ZBdHRyaWJ1dGVzID0gKG5hbWVzOiBzdHJpbmdbXSkgPT4gY29tcG9zZShhdHRyaWJ1dGVOYW1lcywgb25lT2ZDb250YWluZWRJbihuYW1lcykpO1xuXG4gICAgY29uc3QgaXNUb3VjaERldmljZTogYm9vbGVhbiA9ICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpIHx8XG4gICAgICAgIChuYXZpZ2F0b3IubWF4VG91Y2hQb2ludHMgPiAwKSB8fFxuICAgICAgICAobmF2aWdhdG9yLm1zTWF4VG91Y2hQb2ludHMgPiAwKTtcblxuICAgIC8qKioqKipcbiAgICAgKiBDb3VudCB0aGUgbnVtYmVyIG9mIGRpcmVjdCBzaWJsaW5ncyBtYXRjaGluZyBhIHNlbGVjdG9yLFxuICAgICAqKioqKiovXG4gICAgY29uc3QgY291bnQgPSAoc2I6IChlOiBFbGVtZW50KSA9PiBFbGVtZW50IHwgbnVsbCkgPT4ge1xuICAgICAgICBjb25zdCBmbiA9IChlOiBFbGVtZW50LCBhdHRyaWJ1dGVOYW1lczogc3RyaW5nW10sIGkgPSAwKTogbnVtYmVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5leHQgPSBzYihlKTtcbiAgICAgICAgICAgIHJldHVybiBuZXh0ICYmIGNvbnRhaW5zT25lT2ZBdHRyaWJ1dGVzKGF0dHJpYnV0ZU5hbWVzKShuZXh0KSA/IGZuKG5leHQsIGF0dHJpYnV0ZU5hbWVzLCBpICsgMSkgOiBpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZm5cbiAgICB9O1xuXG5cbiAgICBjb25zdCBjb3VudE5leHQ6IChlOiBFbGVtZW50LCBuYW1lczogc3RyaW5nW10pID0+IG51bWJlciA9IGNvdW50KG4gPT4gbi5uZXh0RWxlbWVudFNpYmxpbmcpO1xuICAgIGNvbnN0IGNvdW50UHJldjogKGU6IEVsZW1lbnQsIG5hbWVzOiBzdHJpbmdbXSkgPT4gbnVtYmVyID0gY291bnQobiA9PiBuLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpO1xuXG4gICAgLyoqKioqKlxuICAgICAqIENvdW50IHRoZSBudW1iZXIgb2YgZGlyZWN0IGhpZGRlbiBzZWN0aW9uc1xuICAgICAqKioqKiovXG4gICAgY29uc3QgZ2VuZXJpY0hpZGluZ0VsZW1lbnRzID0gW1xuICAgICAgICBcImRhdGEtaGlkZGVuLXNlY3Rpb25cIixcbiAgICAgICAgaXNUb3VjaERldmljZSA/IFwiZGF0YS1ub24tdG91Y2gtb25seS1zZWN0aW9uXCIgOiBcImRhdGEtdG91Y2gtb25seS1zZWN0aW9uXCJcbiAgICBdO1xuICAgIGNvbnN0IGNvdW50SGlkZGVuU2libGluZ3MgPSAoZm46IChlOiBFbGVtZW50LCBuYW1lczogc3RyaW5nW10pID0+IG51bWJlcikgPT4gKGU6IEVsZW1lbnQpID0+IGZuKGUsIGdlbmVyaWNIaWRpbmdFbGVtZW50cyk7XG5cbiAgICBjb25zdCBub09mSGlkZGVuTGVmdCA9IChlOiBFbGVtZW50KSA9PiBjb3VudFByZXYoZSwgW1wiZGF0YS1yaWdodC1vbmx5LXNlY3Rpb25cIiwgLi4uZ2VuZXJpY0hpZGluZ0VsZW1lbnRzXSk7XG4gICAgY29uc3Qgbm9PZkhpZGRlblJpZ2h0ID0gKGU6IEVsZW1lbnQpID0+IGNvdW50TmV4dChlLCBbXCJkYXRhLWxlZnQtb25seS1zZWN0aW9uXCIsIC4uLmdlbmVyaWNIaWRpbmdFbGVtZW50c10pO1xuXG5cbiAgICAvKioqKioqXG4gICAgICogU3VwcG9ydCBmb3IgbmV4dC1zbGlkZS1pZHhcbiAgICAgKioqKioqL1xuXG4gICAgY29uc3QgZ2V0TmV4dFNsaWRlSW5kZXhIID0gKGU6IEVsZW1lbnQpOiBudW1iZXIgfCBudWxsID0+IHtcbiAgICAgICAgY29uc3QgcyA9IGUuZ2V0QXR0cmlidXRlKFwiZGF0YS1uZXh0LXNsaWRlLWluZGV4aFwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBzID8gcGFyc2VJbnQocywgMTApIDogbnVsbFxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgZGF0YS1uZXh0LXNsaWRlLWluZGV4aCwgbXVzdCBiZSBhIG51bWJlciwgZ290ICR7c31gKTtcbiAgICAgICAgfVxuICAgIH07XG5cblxuICAgIC8qKioqKipcbiAgICAgKiBFeHBvcnRzXG4gICAgICoqKioqKi9cbiAgICBjb25zdCBXZWJ5YXJucyAgOiBhbnkgPSB7XG4gICAgICAgIG5vT2ZIaWRkZW5MZWZ0LFxuICAgICAgICBub09mSGlkZGVuUmlnaHQsXG4gICAgICAgIGdldE5leHRTbGlkZUluZGV4SCxcbiAgICB9O1xuXG5cbiAgICBpZiAoZXhwb3NlQWxsRm9yVGVzdHMpIHtcbiAgICAgICAgLy8gRm9yIEplc3RcbiAgICAgICAgV2VieWFybnMuY291bnROZXh0ID0gY291bnROZXh0O1xuICAgICAgICBXZWJ5YXJucy5jb3VudFByZXYgPSBjb3VudFByZXY7XG4gICAgfVxuXG4gICAgcmV0dXJuIFdlYnlhcm5zO1xufSkpO1xuXG5cblxuXG5cblxuIl19